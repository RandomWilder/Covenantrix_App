<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval';">
    <title>Covenantrix - Contract Intelligence Platform</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <div class="logo-section">
                    <h1>üèõÔ∏è Covenantrix</h1>
                    <span class="subtitle">Contract Intelligence Platform - Proof of Concept</span>
                </div>
                <div class="status-section">
                    <div class="status-indicator" id="statusIndicator">
                        <div class="status-dot"></div>
                        <span id="statusText">Initializing...</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- System Info Panel -->
            <section class="info-panel">
                <h2>System Information</h2>
                <div class="info-grid">
                    <div class="info-item">
                        <strong>Platform:</strong>
                        <span id="platformInfo">Loading...</span>
                    </div>
                    <div class="info-item">
                        <strong>Electron:</strong>
                        <span id="electronVersion">Loading...</span>
                    </div>
                    <div class="info-item">
                        <strong>Node.js:</strong>
                        <span id="nodeVersion">Loading...</span>
                    </div>
                    <div class="info-item">
                        <strong>Chrome:</strong>
                        <span id="chromeVersion">Loading...</span>
                    </div>
                </div>
            </section>

            <!-- API Key Configuration Panel -->
            <section class="api-key-panel">
                <h2>OpenAI API Configuration</h2>
                <div class="api-key-content">
                    <div class="api-key-status-section">
                        <div id="apiKeyStatus" class="api-key-status not-configured">
                            ‚öôÔ∏è API Key Not Configured
                        </div>
                    </div>
                    
                    <div id="apiKeyForm" class="api-key-form">
                        <div class="input-group">
                            <label for="apiKeyInput">OpenAI API Key:</label>
                            <input 
                                type="password" 
                                id="apiKeyInput" 
                                placeholder="sk-..."
                                class="api-key-input"
                            >
                            <button id="submitAPIKeyBtn" class="test-button">Validate & Save</button>
                        </div>
                        <div class="api-key-help">
                            <small>
                                Your API key will be stored securely on your local machine and encrypted.
                                <br>Get your API key from <a href="#" onclick="require('electron').shell.openExternal('https://platform.openai.com/api-keys')">OpenAI Platform</a>
                            </small>
                        </div>
                    </div>
                    
                    <button id="removeAPIKeyBtn" class="remove-button" style="display: none;">
                        Remove API Key
                    </button>
                    
                    <div id="apiKeyMessage" class="api-key-message" style="display: none;"></div>
                </div>
            </section>

            <!-- Backend Status Panel -->
            <section class="status-panel">
                <h2>Backend Status</h2>
                <div class="status-content">
                    <div class="status-item">
                        <button id="testBackendBtn" class="test-button">Test Backend Connection</button>
                        <div id="backendResult" class="result-area"></div>
                    </div>
                </div>
            </section>

            <!-- AI Test Panel -->
            <section class="ai-panel">
                <h2>AI Integration Test</h2>
                <div class="ai-test-content">
                    <div class="input-group">
                        <label for="queryInput">Test Query:</label>
                        <input 
                            type="text" 
                            id="queryInput" 
                            placeholder="Enter a test query about contracts..."
                            value="Analyze this contract for potential risks and opportunities"
                        >
                        <button id="testAiBtn" class="test-button">Send to AI Backend</button>
                    </div>
                    <div id="aiResult" class="result-area"></div>
                </div>
            </section>

            <!-- Document Upload Panel (Minimal) -->
            <section class="ai-panel">
                <h2>Document Upload for LightRAG</h2>
                <div class="ai-test-content">
                    <div class="input-group">
                        <label for="documentInput">Upload Document (PDF/TXT):</label>
                        <input 
                            type="file" 
                            id="documentInput" 
                            accept=".pdf,.txt"
                            class="api-key-input"
                        >
                        <button id="uploadDocBtn" class="test-button">Upload & Process Document</button>
                    </div>
                    <div id="documentResult" class="result-area"></div>
                    
                    <div class="input-group">
                        <small>üí° After uploading documents, use the AI test below to query them!</small>
                    </div>
                </div>
            </section>

            <!-- Logs Panel -->
            <section class="logs-panel">
                <h2>Application Logs</h2>
                <div class="logs-content">
                    <div id="logsArea" class="logs-area"></div>
                    <button id="clearLogsBtn" class="clear-button">Clear Logs</button>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="app-footer">
            <p>Covenantrix 0.5.4 - Proof of Concept for Electron + Python Distribution</p>
        </footer>
    </div>

    <script src="api-key-manager.js"></script>
    <script src="update-manager.js"></script>
    <script src="renderer.js"></script>
</body>
</html>